{% extends "shop/base.html" %}

{% load static %}

{% block title %}Регистрация{% endblock %}

{% block content %}
    <div class="card-header">
        <h3>Регистрация</h3>
    </div>

    <div class=" album py-3 bg-light">
        <div class="container">
            {% csrf_token %}
            <div class="card box-shadow">
                <div class="card-body">
                    <form method="post" class="row" id="registerForm">
                        {{ form.as_p }}
                    </form>
                    <button class="btn btn-lg btn-primary btn-block" type="submit">Зарегистрироваться</button>
                </div>
            </div>
        </div>
    </div>
    <div class="card mb-4 box-shadow">
        <div class="card-body">
            <form id="registerFormAPI">
                <table width="100%">
                    <tr>
                        <td>
                            <div class="mb-3">
                                Имя пользователя:
                                <input type="text" class="form-control" id="userName" placeholder="User Name" required>
                            </div>
                        </td>
                        <td>
                            <div class="mb-3">
                                e-mail:
                                <input type="text" class="form-control" id="emailPost" placeholder="e-mail" required>
                            </div>
                        </td>
                        <td>
                            <div class="mb-3">
                                Пароль:
                                <input type="text" class="form-control" id="passwordPost" placeholder="Password"
                                       required>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="mb-3">
                                Подтверждение пароля:
                                <input type="text" class="form-control" id="password2Post" placeholder="Password"
                                       required>
                            </div>
                        </td>
                        <td>
                            <div class="mb-3">
                                Компания:
                                <input type="text" class="form-control" id="companyPost" placeholder="Company" required>
                            </div>
                        </td>
                        <td>
                            <div class="mb-3">
                                Должность:
                                <input type="text" class="form-control" id="positionPost" placeholder="Position"
                                       required>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="mb-3">
                                Тип (shop, customer):
                                <input type="text" class="form-control" id="positionPost" placeholder="Type" required>
                            </div>
                        </td>
                        <td>
                            <button type="submit" class="btn btn-success">Зарегистрироваться</button>
                        </td>
                    </tr>
                </table>
                <div class="mb-3">
                    <label for="result">Ответ:</label>
                    <textarea class="form-control" id="result"
                              style="font-family:Monospace;"
                              placeholder="Ответ" readonly>
                    </textarea>
                </div>
            </form>
        </div>
    </div>
{% endblock content %}

{% block javascript %}
    <script>
        $("#getTokenForm").on('submit', (e) => {
            e.preventDefault();
            var data = {
                email: getTokenForm.elements["emailPost"].value,
                password: getTokenForm.elements["passwordPost"].value,
            }
            getToken({% url 'shop:token_obtain' %}, data, getTokenForm.elements["tokenPost"]);
        })
    </script>
{% endblock %}