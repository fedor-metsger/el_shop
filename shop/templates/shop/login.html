{% extends "shop/base.html" %}

{% load static %}

{% block title %}Вход{% endblock %}

{% block content %}
    <div class="card-header">
        <h3>Вход</h3>
    </div>

    <div class="album py-3 bg-light">
        <div class="container">
            <div class="card mb-4 box-shadow">
                <div class="card-body">
                    <form method="post" id="loginForm">
                        {% csrf_token %}
                        {{ form.as_p }}
                        <button class="btn btn-primary" type="submit">Войти</button>
                        <input name="next" type="hidden" value="{% url 'shop:product' %}">
                    </form>

                </div>
            </div>
            <div class="card mb-4 box-shadow">
                <div class="card-body">
                    <form id="getTokenForm">
                        <div class="mb-3">
                            <label for="tokenPost">e-mail:</label>
                            <input type="text" class="form-control" id="emailPost" placeholder="e-mail" required>
                        </div>
                        <div class="mb-3">
                            <label for="tokenPost">Пароль:</label>
                            <input type="text" class="form-control" id="passwordPost" placeholder="Password" required>
                        </div>
                        <button type="submit" class="btn btn-success">Получить токен</button>
                        <div class="mb-3">
                            <label for="tokenPost">Токен:</label>
                            <textarea class="form-control" id="tokenPost"
                                      style="font-family:Monospace;"
                                      placeholder="Token" readonly>
                    </textarea>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block javascript %}
    <script>
        $("#getTokenForm").on('submit', (e) => {
            e.preventDefault();
            var data = {
                email: getTokenForm.elements["emailPost"].value,
                password: getTokenForm.elements["passwordPost"].value,
            }
            getToken("{% url 'shop:token_obtain' %}", data, getTokenForm.elements["tokenPost"]);
        })
    </script>
{% endblock %}
